"use strict";(self.webpackChunkyskye=self.webpackChunkyskye||[]).push([[971],{4859:(a,n,s)=>{s.r(n),s.d(n,{comp:()=>J,data:()=>Z});var e=s(641);const p=s.p+"assets/img/1f986c49f97446cc73aada1bbc928408.18ae3a01.png",i=s.p+"assets/img/ca332f9b4d10ad8b23c058e97ceeb8a2.23c88b01.png",l=s.p+"assets/img/6dbdf6b11ca4a00e3710561fe4e72dba.329af3c3.png",c=s.p+"assets/img/728ccf9c6cbd6c5ad810daadd3be497f.0c8160ae.png",d=s.p+"assets/img/eb70c797dc3bc86ed1a16647747d17f9.2e18d55f.png",r=s.p+"assets/img/3f4f6a878975cfebc1fc2e936b4a0023.71538b07.png",t=s.p+"assets/img/488fdb627a9bfbeccb78c5097a925b0b.e7bc111f.png",A=s.p+"assets/img/c363de7a9445facbb1fdfef24e6caf8a.d16254d0.png",v=s.p+"assets/img/bcddd14b9a10ec4ad96a8c979a5f56fc.46299e1b.png",u=s.p+"assets/img/731f7d81dde3dc90c1056a80c01d4e69.15801c6c.png",m=s.p+"assets/img/2e2546ca7e1d804c135d69f671ae358c.669d3f22.png",b=s.p+"assets/img/c7f1269e4ddba347b995edd690338e6d.37ead172.png",o=s.p+"assets/img/00ceb0b37c795e7ad7ff57a43205871e.9cd2c320.png",g=s.p+"assets/img/21673ca13ae61f4f2e24af65a6626b81.afc74a29.png",h=s.p+"assets/img/ab30a3aab616196529ff02618c8a5251.e36e0d32.png",f=s.p+"assets/img/9c33e0a627fd3b505a11d69c03e27c00.3278418a.png",y=s.p+"assets/img/0993d7bbd342b5e1a4d00b2d463ccb17.6e7b658e.png",k=s.p+"assets/img/9f905f208f029d9dd0166593427aaa17.285628e5.png",x=s.p+"assets/img/e5de71a8941d79afa4c312b5c26a7c18.63516e8a.png",w=s.p+"assets/img/2e267d4243b5117f80a0e51314175b99.f79b5799.png",q=s.p+"assets/img/f8cd57e621560c4b55771971ed84c5e7.cc8abf67.png",O=s.p+"assets/img/22ae952c0a5928a63e9cf50f8d788ea9.1a1036f7.png",V=s.p+"assets/img/20a3f11ab556ed8418cd0b794bd63ac0.3a27569c.png",j=s.p+"assets/img/150dd4c6d4007eed4017a9edb583e12d.a64bf8d6.png",H=s.p+"assets/img/7044400597ff5621706e61c2c9a94eca.343683a2.png",C=s.p+"assets/img/f525145a368df64817aff15dba844602.56d00e61.png",I=s.p+"assets/img/54b153e2c8b81f8efe960ba4e1f99bc3.c2757b96.png",E=s.p+"assets/img/2015fa6a55066702eea4cdba0837d36c.63d2f96b.png",X={},J=(0,s(6262).A)(X,[["render",function(a,n){return(0,e.uX)(),(0,e.CE)("div",null,n[0]||(n[0]=[(0,e.Fv)('<h2 id="【出现的形式】" tabindex="-1"><a class="header-anchor" href="#【出现的形式】"><span>【出现的形式】</span></a></h2><p>出现的话往往是python编写，然后编译好的exe或者elf文件，我们需要做的就是找到源码，分析逻辑，进行解密</p><h2 id="【生成pyc文件】" tabindex="-1"><a class="header-anchor" href="#【生成pyc文件】"><span>【生成pyc文件】</span></a></h2><p>使用的工具就是pyinstxtractor</p><p><a href="https://www.yuque.com/attachments/yuque/0/2024/zip/40360107/1711534244541-742bff1f-b64c-4190-9347-33fdb07855ec.zip" target="_blank" rel="noopener noreferrer">pyinstxtractor-2023.08.zip</a></p><p>其中的py文件可以实现将exe文件或者elf文件，打包为</p><p><img src="'+p+'" alt=""></p><p>使用方法（以snake.elf这个题目为例）</p><p>解压，将目标放入文件夹</p><p><img src="'+i+'" alt=""></p><p>在这里打开cmd窗口 ,输入指令<code>python pyinstxtractor.py snake</code></p><p><img src="'+l+'" alt=""></p><p>呈现如下就是成功，发现文件中多了一个_extracted文件夹，打开 ，去里面找到&quot;目标文件名.pyc&quot;的文件（往往与struct.pyc一并出现，都有用）</p><p><img src="data:image/png;base64,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" alt=""></p><p><img src="'+c+'" alt=""></p><p>注：进行完上述操作之后，可能会遇到文件头结构需要补充修改的情况，就是讲sanke和struct两个pyc文件放入010查看sanke的文件头是否与struct相同，不同的话要把后者的内容补充上去（目前做题还没遇到过这样的情况，可能现在这个工具比较好用了）再进行下一步操作。</p><h2 id="【生成py文件-实现反编译】" tabindex="-1"><a class="header-anchor" href="#【生成py文件-实现反编译】"><span>【生成py文件，实现反编译】</span></a></h2><p>这一步实现pyc文件转化为py源码</p><h3 id="一-使用在线反编译网站" tabindex="-1"><a class="header-anchor" href="#一-使用在线反编译网站"><span>（一）使用在线反编译网站</span></a></h3><p><a href="https://tool.lu/pyc/" target="_blank" rel="noopener noreferrer">python反编译 - 在线工具</a></p><p>这个网站可以实现的版本较多，但是有使用限制</p><p><a href="http://tools.bugscaner.com/decompyle/" target="_blank" rel="noopener noreferrer">在线pyc,pyo,python,py文件反编译，目前支持python1.5到3.6版本的反编译-在线工具</a></p><p>这个网站使用方便但是很久没更新了</p><p>一般直接将上一步生成的pyc文件放入其中就可以生成py文件</p><h3 id="二-pycdc工具进行反编译" tabindex="-1"><a class="header-anchor" href="#二-pycdc工具进行反编译"><span>（二）pycdc工具进行反编译</span></a></h3><p>其实在线工具就是利用这个玩意进行了python的反编译，之所以我们会用到这个工具，因为做题遇到了一个使用高版本python编写的exe，使用在线工具是无法完美反编译出来的。其实使用这个pycdc的话也会报错，但是由于我们在本地使用的脚本，我们就可以修改文件中的代码，实现绕过一些报错，大致反编译出来源码进行解密（下面第三点讲到）</p><p>其次就是，到后期，在没有联网的比赛中，这个工具就显得尤为重要了，我们接下来进行pycdc的几种安装方式的教程。</p><p>Windows与Linux系统安装的大致思路相似</p><p>github上下载压缩包/文件 - cmake进行编译生成可执行文件 - 成功运行</p><h4 id="linux系统-利用wsl-方便进行源码修改" tabindex="-1"><a class="header-anchor" href="#linux系统-利用wsl-方便进行源码修改"><span>Linux系统（利用wsl，方便进行源码修改）</span></a></h4><p>参考了上面提到的题目的题解，认识到了wsl这个伟大的功能（在windows的命令框中实现我们的linux操作）这篇文章讲的十分详尽了，本文就不再过多赘述了，直接进入我们安装pycdc的整正题</p><p><a href="https://zhuanlan.zhihu.com/p/146545159" target="_blank" rel="noopener noreferrer">安利] WSL Linux 子系统，真香！完整实操 - 知乎</a></p><p>（在linux上和下面的操作是一样的）</p><p>安装完毕wsl之后，打开cmd输入wsl切换系统</p><p><img src="'+d+'" alt=""></p><h5 id="先熟悉几个指令-萌新可以看看" tabindex="-1"><a class="header-anchor" href="#先熟悉几个指令-萌新可以看看"><span>先熟悉几个指令（萌新可以看看）</span></a></h5><p>cd</p><p>地址跳转功能，我们输入cd ~之后会跳到最干净的地址</p><p><img src="'+r+'" alt=""></p><p>ls</p><p>查看文件目录</p><p><img src="'+t+'" alt=""></p><p>我们发现就是我们的这几个目录</p><p><img src="'+A+'" alt=""></p><h5 id="正式安装" tabindex="-1"><a class="header-anchor" href="#正式安装"><span>正式安装</span></a></h5><h6 id="_1-准备工作-安装gcc-cmake-bulid包" tabindex="-1"><a class="header-anchor" href="#_1-准备工作-安装gcc-cmake-bulid包"><span>（1）准备工作:安装gcc，cmake，bulid包</span></a></h6><p><code>sudo apt-get update</code></p><p><code>sudo apt-get install gcc</code></p><p><code>sudo apt install cmake</code></p><p><code>sudo apt install build-essential</code>（第一次装的时候就是因为这个包没装上，cmake一直无法编译）</p><h6 id="_2-git拉取文件" tabindex="-1"><a class="header-anchor" href="#_2-git拉取文件"><span>（2）git拉取文件</span></a></h6><p><code>git clone https://github.com/zrax/pycdc.git</code></p><p>这样一来，再输入ls之后会像我上面展示的一样出现pycdc这个文件夹，当然我们还要去编译他</p><h6 id="_3-地址切换到pycdc-进行编译" tabindex="-1"><a class="header-anchor" href="#_3-地址切换到pycdc-进行编译"><span>（3）地址切换到pycdc，进行编译</span></a></h6><p><code>cd pycdc</code></p><p><img src="'+v+'" alt=""></p><h6 id="_4-编译过程" tabindex="-1"><a class="header-anchor" href="#_4-编译过程"><span>（4）编译过程</span></a></h6><p><code>cmake .</code></p><p><img src="'+u+'" alt=""></p><p><code>make</code></p><p><img src="'+m+'" alt=""></p><p><code>sudo make install</code></p><p><img src="'+b+'" alt=""></p><p>看到安装到bin目录下的两个文件就证明我们成功了，可以正常使用了，是不是非常方便</p><h5 id="使用方法" tabindex="-1"><a class="header-anchor" href="#使用方法"><span>使用方法</span></a></h5><p>进入存放pyc文件的文件夹，打开终端进入wsl</p><p><img src="'+o+'" alt=""></p><p>输入命令<code>pycdc ./rc4.pyc</code></p><p><img src="'+g+'" alt=""></p><p>顺利反编译</p><p>当然你还可以选择直接生成py文件，命令</p><p><code>pycdc ./rc4.pyc &amp;gt;&amp;gt; ../newrc4.py</code>就会在上一层目录中生成这个py文件</p><p><img src="'+h+'" alt=""></p><p>和在窗口打开的并无差异</p><p><img src="'+f+'" alt=""></p><h4 id="windows系统" tabindex="-1"><a class="header-anchor" href="#windows系统"><span>Windows系统</span></a></h4><p>windows的操作可能比较繁琐，cmake的安装可能需要一定功夫，这里也给大家讲讲</p><h5 id="前期准备" tabindex="-1"><a class="header-anchor" href="#前期准备"><span>前期准备</span></a></h5><p>首先就是需要的工具，vscode上的一些插件提前下载好</p><p><img src="'+y+'" alt=""></p><p>然后去下载一个cmake和MinGW，按照这个两篇文章来就好</p><p><a href="https://blog.csdn.net/qq_63585949/article/details/127079529" target="_blank" rel="noopener noreferrer">CMake 安装教程_cmake下载安装教程-CSDN博客</a></p><p><a href="https://blog.csdn.net/yvge669/article/details/124564622" target="_blank" rel="noopener noreferrer">Mingw快捷安装教程 并完美解决出现的下载错误：The file has been downloaded incorrectly-CSDN博客</a></p><h5 id="正式安装-1" tabindex="-1"><a class="header-anchor" href="#正式安装-1"><span>正式安装</span></a></h5><p>（1）官网下载pycdc压缩包文件</p><p><a href="https://github.com/zrax/pycdc" target="_blank" rel="noopener noreferrer">GitHub - zrax/pycdc: C++ python bytecode disassembler and decompiler</a></p><p>（2）解压的文件夹放入vscode中</p><p><img src="'+k+'" alt=""></p><p>ctrl shift P 选择生成</p><p><img src="'+x+'" alt=""></p><p>下一步选择gcc</p><p><img src="'+w+'" alt=""></p><p>最后发现出现了bulid文件夹，控制台也显示编译完成，在我们的文件夹的位置就出现了编译好的可执行文件</p><p><img src="'+q+'" alt=""></p><p><img src="'+O+'" alt=""></p><h5 id="使用方法-1" tabindex="-1"><a class="header-anchor" href="#使用方法-1"><span>使用方法</span></a></h5><p>将上面的两个exe放入我们的pyc文件夹中，在终端打开</p><p><img src="'+V+'" alt=""></p><p>输入命令 <code>pycdc.exe rc4.pyc</code></p><p><img src="'+j+'" alt=""></p><h3 id="三-应用在题目中-随意修改编译我们的脚本源码" tabindex="-1"><a class="header-anchor" href="#三-应用在题目中-随意修改编译我们的脚本源码"><span>（三）应用在题目中，随意修改编译我们的脚本源码</span></a></h3><p>像上面这个图片中，我们并没有生成完整的反编译源码，原因是编写题目的python版本太高，pycdc在识别的时候出现了问题于是就没有继续进行编译，导致大量的信息丢失（当然我觉得pycdc的作者也会在后续进行高版本更新，无论是在线还是本地反编译都会没有问题）</p><p>那如果确实出现了这样的错误，我们有两种解决办法</p><p>（1）使用pycdas，生成汇编代码，进行阅读</p><p>（2）查看报错，让进入源码进行适当修改，编译出新的pycdc生成不报错的反编译。</p><p>这里只讲讲第二种方法。</p><p>使用wls的话，我们打开vscode</p><p><img src="'+H+'" alt=""></p><p>选择右边的远程资源管理器，打开我们的pycdc文件夹</p><p><img src="'+C+'" alt=""></p><p>进入这个ASTree.cpp的文件，copy刚才反汇编的报错</p><p><code>Unsupported opcode: JUMP_BACKWARD</code>在vscode中进行检索</p><p>找到了这里</p><p><img src="'+I+'" alt=""></p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>fprintf(stderr, &quot;Unsupported opcode: %s\\n&quot;, Pyc::OpcodeName(opcode &amp;amp; 0xFF));</span></span>\n<span class="line"><span>cleanBuild = false;</span></span>\n<span class="line"><span>//return new ASTNodeList(defblock-&amp;gt;nodes());</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里的return语句就是我们没找到反编译的字节之后，我就不再继续反编译return，我们注释掉这条语句，重新按照（二）中的过程进行编译，这样子我们的pycdc就是不会再return的工具了</p><p><img src="'+E+'" alt=""></p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span># Source Generated with Decompyle++</span></span>\n<span class="line"><span># File: rc4.pyc (Python 3.11)</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>import time</span></span>\n<span class="line"><span>a = input()</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>def swap_uchar(x, y):</span></span>\n<span class="line"><span>    return (y, x)</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>def rc4_ksa(key):</span></span>\n<span class="line"><span>    sbox = list(range(256))</span></span>\n<span class="line"><span>    j = 0</span></span>\n<span class="line"><span>    for i in range(256):</span></span>\n<span class="line"><span>        j = (j + sbox[i] + key[i % len(key)]) % 256</span></span>\n<span class="line"><span>        (sbox[i], sbox[j]) = swap_uchar(sbox[i], sbox[j])</span></span>\n<span class="line"><span>    return sbox</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>def rc4_prga(sbox, data_length):</span></span>\n<span class="line"><span>    i = 0</span></span>\n<span class="line"><span>    j = 0</span></span>\n<span class="line"><span>    key_stream = bytearray()</span></span>\n<span class="line"><span>    for k in range(data_length):</span></span>\n<span class="line"><span>        i = (i + 1) % 256</span></span>\n<span class="line"><span>        j = (j + sbox[i]) % 256</span></span>\n<span class="line"><span>        (sbox[i], sbox[j]) = swap_uchar(sbox[i], sbox[j])</span></span>\n<span class="line"><span>        t = (sbox[i] + sbox[j]) % 256</span></span>\n<span class="line"><span>        key_stream.append(sbox[t])</span></span>\n<span class="line"><span>    return key_stream</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>def rc4_crypt(data, key_stream):</span></span>\n<span class="line"><span>    result = bytearray()</span></span>\n<span class="line"><span>    for i in range(len(data)):</span></span>\n<span class="line"><span>        result.append(data[i] ^ key_stream[i])</span></span>\n<span class="line"><span>    return result</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>def tea(v, k):</span></span>\n<span class="line"><span>    delta = 0x9E3779B9</span></span>\n<span class="line"><span>    mask = 0xFFFFFFFF</span></span>\n<span class="line"><span>    rounds = 32</span></span>\n<span class="line"><span>    v1 = v[1]</span></span>\n<span class="line"><span>    v0 = v[0]</span></span>\n<span class="line"><span>    sum = delta * rounds &amp;amp; mask</span></span>\n<span class="line"><span>    for i in range(rounds):</span></span>\n<span class="line"><span>        v1 -= (v0 &amp;lt;&amp;lt; 4) + k[2] ^ v0 + sum ^ (v0 &amp;gt;&amp;gt; 5) + k[3]</span></span>\n<span class="line"><span>        v1 &amp;amp;= mask</span></span>\n<span class="line"><span>        v0 -= (v1 &amp;lt;&amp;lt; 4) + k[0] ^ v1 + sum ^ (v1 &amp;gt;&amp;gt; 5) + k[1]</span></span>\n<span class="line"><span>        v0 &amp;amp;= mask</span></span>\n<span class="line"><span>        sum -= delta</span></span>\n<span class="line"><span>        sum &amp;amp;= mask</span></span>\n<span class="line"><span>    return [</span></span>\n<span class="line"><span>            v0,</span></span>\n<span class="line"><span>            v1]</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>def main():</span></span>\n<span class="line"><span>    key = &#39;abcdefghijklmnopqrstuvwxyz&#39;</span></span>\n<span class="line"><span>    key3 = [</span></span>\n<span class="line"><span>        19088743,</span></span>\n<span class="line"><span>        0x89ABCDEF,</span></span>\n<span class="line"><span>        0xFEDCBA98,</span></span>\n<span class="line"><span>        1985229328]</span></span>\n<span class="line"><span>    data = bytearray(str(a), &#39;utf-8&#39;)</span></span>\n<span class="line"><span>    sbox = rc4_ksa(bytearray(key, &#39;utf-8&#39;))</span></span>\n<span class="line"><span>    key_stream = rc4_prga(sbox[:], len(data))</span></span>\n<span class="line"><span>    encrypted_data = rc4_crypt(data, key_stream)</span></span>\n<span class="line"><span>    b = (lambda .0: for x in .0:      </span></span>\n<span class="line"><span>format(x, &#39;02X&#39;)None)(encrypted_data())</span></span>\n<span class="line"><span>    key_list = [</span></span>\n<span class="line"><span>        47,</span></span>\n<span class="line"><span>        138,</span></span>\n<span class="line"><span>        127,</span></span>\n<span class="line"><span>        57,</span></span>\n<span class="line"><span>        117,</span></span>\n<span class="line"><span>        188,</span></span>\n<span class="line"><span>        51,</span></span>\n<span class="line"><span>        143,</span></span>\n<span class="line"><span>        17,</span></span>\n<span class="line"><span>        22]</span></span>\n<span class="line"><span>    encrypted_values = range(0, len(b), 16)()</span></span>\n<span class="line"><span>    original_data = []</span></span>\n<span class="line"><span>    for i, encrypted_value in enumerate(encrypted_values):</span></span>\n<span class="line"><span>        encrypted_value = encrypted_value.ljust(16, &#39;0&#39;)</span></span>\n<span class="line"><span>        key2 = (key_list[i] &amp;gt;&amp;gt; 4) + ((key_list[i] &amp;amp; 15) &amp;lt;&amp;lt; 4)</span></span>\n<span class="line"><span>        original_data.append([</span></span>\n<span class="line"><span>            int(encrypted_value[:8], 16) ^ key2,</span></span>\n<span class="line"><span>            int(encrypted_value[8:], 16) ^ key2])</span></span>\n<span class="line"><span>        decrypted_values = original_data()</span></span>\n<span class="line"><span>        check = (lambda .0: for value in .0:</span></span>\n<span class="line"><span>[ hex(value[0])[2:] + &#39; &#39; + hex(value[1])[2:] + &#39; &#39; ])(decrypted_values()).upper().strip()</span></span>\n<span class="line"><span>        if check == &#39;2E895417 9EDAC23D E4A8A87A B63C2690 E6423D70 F7E9C8AD&#39;:</span></span>\n<span class="line"><span>            print(&#39;yea!&#39;)</span></span>\n<span class="line"><span>            time.sleep(10)</span></span>\n<span class="line"><span>            quit()</span></span>\n<span class="line"><span>            return None</span></span>\n<span class="line"><span>        &#39;&#39;.join(&#39;nooooooooooooooooooooooooooooooooooooo&#39;)</span></span>\n<span class="line"><span>        time.sleep(10)</span></span>\n<span class="line"><span>        quit()</span></span>\n<span class="line"><span>        return None</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>if __name__ == &#39;__main__&#39;:</span></span>\n<span class="line"><span>    main()</span></span>\n<span class="line"><span>return None</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>题解就写在别的文章中了，题目附件放到这里了</p><p><a href="https://www.yuque.com/attachments/yuque/0/2024/zip/40360107/1711605481131-363c25a3-294d-41c0-8b32-b83f26aef458.zip" target="_blank" rel="noopener noreferrer">RC4.zip</a></p><h2 id="【总结】" tabindex="-1"><a class="header-anchor" href="#【总结】"><span>【总结】</span></a></h2><p>通过这次的学习，深入了解了python的反编译过程，学习到了wsl这个方便的功能，也简单学习了linux上的一些操作。</p><p>参考文章：</p><p><a href="https://blog.csdn.net/qq_63585949/article/details/127080253" target="_blank" rel="noopener noreferrer">Python 反编译：pycdc工具的使用-CSDN博客</a></p><p><a href="https://ephrain.net/linux-%E4%BD%BF%E7%94%A8-decompile-pycdc-%E5%8F%8D%E7%B5%84%E8%AD%AF-pyc-%E6%AA%94%E6%A1%88/" target="_blank" rel="noopener noreferrer">Linux] 使用 Decompile++ (pycdc) 反組譯 pyc 檔案 | EPH 的程式日記</a></p><p><a href="https://zhuanlan.zhihu.com/p/146545159" target="_blank" rel="noopener noreferrer">安利] WSL Linux 子系统，真香！完整实操 - 知乎</a></p>',126)]))}]]),Z=JSON.parse('{"path":"/article/yojiotyd/","title":"Python反编译保姆级教程","lang":"zh-CN","frontmatter":{"title":"Python反编译保姆级教程","tags":["学习","CTF","逆向"],"createTime":"2024/12/07 20:57:55","permalink":"/article/yojiotyd/","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem(\'vuepress-theme-appearance\') || \'auto\';const sm = window.matchMedia && window.matchMedia(\'(prefers-color-scheme: dark)\').matches;const isDark = um === \'dark\' || (um !== \'light\' && sm);document.documentElement.dataset.theme = isDark ? \'dark\' : \'light\';})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle(\'mac\', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"]]},"headers":[{"level":2,"title":"【出现的形式】","slug":"【出现的形式】","link":"#【出现的形式】","children":[]},{"level":2,"title":"【生成pyc文件】","slug":"【生成pyc文件】","link":"#【生成pyc文件】","children":[]},{"level":2,"title":"【生成py文件，实现反编译】","slug":"【生成py文件-实现反编译】","link":"#【生成py文件-实现反编译】","children":[{"level":3,"title":"（一）使用在线反编译网站","slug":"一-使用在线反编译网站","link":"#一-使用在线反编译网站","children":[]},{"level":3,"title":"（二）pycdc工具进行反编译","slug":"二-pycdc工具进行反编译","link":"#二-pycdc工具进行反编译","children":[]},{"level":3,"title":"（三）应用在题目中，随意修改编译我们的脚本源码","slug":"三-应用在题目中-随意修改编译我们的脚本源码","link":"#三-应用在题目中-随意修改编译我们的脚本源码","children":[]}]},{"level":2,"title":"【总结】","slug":"【总结】","link":"#【总结】","children":[]}],"readingTime":{"minutes":7.43,"words":2230},"filePathRelative":"2.ctf/Python反编译保姆级教程.md","categoryList":[{"id":"fb53bb","sort":2,"name":"ctf"}]}')}}]);